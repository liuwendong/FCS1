{"remainingRequest":"/Users/apple/Desktop/华融催收APP开发/fcs/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/华融催收APP开发/fcs/src/pages/addRmas/component/AddPhoto.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/Desktop/华融催收APP开发/fcs/src/pages/addRmas/component/AddPhoto.vue","mtime":1541065400196},{"path":"/Users/apple/Desktop/华融催收APP开发/fcs/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/apple/Desktop/华融催收APP开发/fcs/node_modules/cache-loader/dist/cjs.js","mtime":1539243342312},{"path":"/Users/apple/Desktop/华融催收APP开发/fcs/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: \"addPhoto\",\n  data() {\n    return {\n      imgList: [],\n      datas: new FormData(),\n      files: 0,\n      size: 0\n    };\n  },\n  methods: {\n    //调用手机摄像头并拍照\n    getImage() {\n      let self = this;\n      let cmr = plus.camera.getCamera();\n      cmr.captureImage(\n        function(p) {\n          plus.io.resolveLocalFileSystemURL(\n            p,\n            function(entry) {\n              console.log(entry.toLocalURL() + \" name=\" + entry.name);\n              self.imgList.push(entry.toLocalURL());\n            },\n            function(e) {\n              console.log(\"读取拍照文件错误\" + e.message);\n              plus.nativeUI.toast(\"读取拍照文件错误：\" + e.message);\n            }\n          );\n        },\n        function(e) {\n          console.log(\"dddddddddd\" + e.message);\n        },\n        {\n          filter: \"image\"\n        }\n      );\n    },\n    //从相册选择照片\n    galleryImgs() {\n      let self = this;\n      plus.gallery.pick(\n        function(event) {\n          console.log(\"选择照片成功\");\n          for (var i in event.files) {\n            console.log(event.files[i]);\n            self.imgList.push(event.files[i]);\n          }\n        },\n        function(error) {\n          console.log(\"选择图片失败\" + error.message);\n        },\n        {\n          filter: \"image\",\n          multiple: true,\n          system: true\n        }\n      );\n    },\n    //点击事件，弹出选择摄像头和相册的选项\n    showActionSheet() {\n      let self = this;\n      let bts = [\n        {\n          title: \"拍照\"\n        },\n        {\n          title: \"从相册选择\"\n        }\n      ];\n      plus.nativeUI.actionSheet(\n        {\n          cancel: \"取消\",\n          buttons: bts\n        },\n        function(e) {\n          if (e.index == 1) {\n            self.getImage();\n          } else if (e.index == 2) {\n            self.galleryImgs();\n          }\n        }\n      );\n    },\n    fileChange(el) {\n      this.files = document.getElementById(\"upload_file\").get(0).files;\n      console.log(this.files.length);\n      for (let i = 0; i < this.files.length; i++) {\n        this.datas.append(\"file\", this.files[i]);\n      }\n      this.show1 = false;\n      console.log(typeof this.files);\n      console.log(this.files);\n      if (!el.target.files[0].size) return;\n      this.fileList(el.target);\n      el.target.value = \"\";\n    },\n    fileList(fileList) {\n      let files = fileList.files;\n      for (let i = 0; i < files.length; i++) {\n        //判断是否为文件夹\n        if (files[i].type != \"\") {\n          this.fileAdd(files[i]);\n        } else {\n          //文件夹处理\n          this.folders(fileList.items[i]);\n        }\n      }\n    },\n    //文件夹处理\n    folders(files) {\n      let _this = this;\n      //判断是否为原生file\n      if (files.kind) {\n        files = files.webkitGetAsEntry();\n      }\n      files.createReader().readEntries(function(file) {\n        for (let i = 0; i < file.length; i++) {\n          if (file[i].isFile) {\n            _this.foldersAdd(file[i]);\n          } else {\n            _this.folders(file[i]);\n          }\n        }\n      });\n    },\n    fileAdd(file) {\n      //总大小\n      this.size = this.size + file.size;\n      //判断是否为图片文件\n      if (file.type.indexOf(\"image\") == -1) {\n        file.src = \"wenjian.png\";\n        this.imgList.push({\n          file\n        });\n      } else {\n        let reader = new FileReader();\n        reader.vue = this;\n        reader.readAsDataURL(file);\n        reader.onload = function() {\n          file.src = this.result;\n          this.vue.imgList.push({\n            file\n          });\n        };\n      }\n    },\n    fileDel(index) {\n      let self = this;\n      self.imgList.splice(index, 1);\n    },\n    bytesToSize(bytes) {\n      if (bytes === 0) {\n        return \"0 B\";\n      }\n      let k = 1000, // or 1024\n        sizes = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"],\n        i = Math.floor(Math.log(bytes) / Math.log(k));\n      return (bytes / Math.pow(k, i)).toPrecision(3) + \" \" + sizes[i];\n    },\n    dragenter(el) {\n      el.stopPropagation();\n      el.preventDefault();\n    },\n    dragover(el) {\n      el.stopPropagation();\n      el.preventDefault();\n    },\n    drop(el) {\n      el.stopPropagation();\n      el.preventDefault();\n      this.fileList(el.dataTransfer);\n    },\n    shows(et, tx) {\n      this.strut = et;\n      this.txt = tx;\n    },\n    handleClick() {\n      this.$store.commit(\"add\");\n    }\n  },\n  computed: {\n    showImg() {\n      return this.imgList.length > 0;\n    }\n  }\n};\n",null]}